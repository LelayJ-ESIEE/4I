#include "../include/gestionFichiers.h"

char* litDixCaracteres(int fd){
    int i;
    char* buffer;
    ssize_t r;

    buffer = malloc(11 * sizeof(char));
    if(buffer==NULL) perror("Buffer NULL");
    for(i=0;i<11;i++) buffer[i]='x';

    r = read(fd, buffer, 11);
    if(r == -1){
        perror("Error on read");
        free(buffer);
        return NULL;
    }
    buffer[10] = '\0';

    i = close(fd);
    if(i == -1) perror("Error on close");

    return buffer;
}

char* litLigne(int fd){
    int i;
    char* buffer;
    ssize_t r;

    buffer = malloc(TAILLEBUF+1 * sizeof(char));
    if(buffer==NULL) perror("Buffer NULL");
    for(i=0;i<=TAILLEBUF+1;i++) buffer[i]='x';

    r = read(fd, buffer, TAILLEBUF+1);
    if(r == -1){
        perror("Error on read");
        free(buffer);
        return NULL;
    }

    for(i=0;i<=TAILLEBUF+1;i++){
        if(buffer[i] == '\n' || buffer[i] == '\0'){
            buffer[i]='\0';
            return buffer;
        }
    }

    free(buffer);

    return NULL;
}

void writeFile(int fd, char* buffer){
    ssize_t w;

    w = write(fd, buffer, TAILLEBUF);
    if(w == -1){
        perror("Error on write");
        return;
    }

    return;
}