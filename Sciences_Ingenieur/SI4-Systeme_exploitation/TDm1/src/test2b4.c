#include "../include/gestionFichiers.h"

int main(int argc, char* argv[]){

    int fd;
    char* s;
    int i;
    int offset = 0;
    int counter = 0;
    
    if(argc < 2){
        printf("Missing argument : Please give a file path in argument\n");
        return 2;
    }

    fd = open(argv[1],O_RDONLY);
    if(fd == -1){
        perror("Error on open");
        return 1;
    }

    s = litLigne(fd);
    
    while(s != NULL){
        counter += 1;
        for(i=0; i<TAILLEBUF+1; i++){
            if(s[i] == '\0')
                break;
        }
        offset = lseek(fd, offset+i+1, SEEK_SET);
        free(s);
        s = litLigne(fd);
    }
    free(s);

    printf("%s has %d lines\n", argv[1], counter);

    i = close(fd);
    if(i == -1) {
        perror("Error on close");
        return 3;
    }

    return 0;
}