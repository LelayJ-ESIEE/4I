#include "../include/gestionFichiers.h"

int main(int argc, char* argv[]){
    int fdr;
    char* s;
    off_t offset = 0;
    int i;

    if(argc < 2){
        printf("Missing argument : Please give two file paths in argument\n");
        return 2;
    }

    if(argc > 2){
        printf("Too many arguments : Please give two file paths in argument\n");
        return 2;
    }

    fdr = open(argv[1],O_RDONLY);
    if(fdr == -1){
        perror("Error on readonly open");
        return 1;
    }

    s = litLigne(fdr);

    while(s != NULL){
        writeFile(1, s);

        for(i=0; i<TAILLEBUF+1; i++){
            if(s[i] == '\0')
                break;
        }
        offset = lseek(fdr, offset+i+1, SEEK_SET);
        free(s);
        s = litLigne(fdr);
    }

    i = close(fdr);
    if(i == -1) {
        perror("Error on close");
        return 3;
    }

    return 0;
}